
Table and rows
--------------

__Definition__

    (define-table
      (customers-table
        "customers")
      (customer-row
        ("customer-id" integer)
        ("billing-address" string)
        ("credit-limit" number))

- Defines a table named customers composed of:
 - A first column of type integer named customer-id (auto-generated by convention)
 - A second column of type string named billing-address
 - A third column of type number named credit-limit

- Supported column types:
 - boolean
 - date
 - datetime
 - day-of-week
 - integer
 - number
 - string
 - time

__Contructor and selectors__

    (define customer-row (make-customer-row 0 "Address" 5000.00))
    (customer-row-customer-id customer-row)
    (customer-row-billing-address customer-row)
    (customer-row-credit-limit customer-row)

- 0
- "Address"
- 5000.

__Mutators__

    (customer-row-billing-address-set! customer-row "Mutated address")
    (customer-row-credit-limit-set! customer-row 8000.00)

Connections
-----------

    (with-sql-connection "customers.db"
      (lambda (sql-connection)
        (display "I have a connection.")))

- Opens a connection to the database customers.db
- The connection is passed to the specified procedure
- The connection is automatically closed afterward

Basic CRUD operations
---------------------

__Insertion__

    (customers-table-insert
      sql-connection
      (make-customer-row 0 "Address" 5000.00))

- Inserts a customer-row
- Returns the auto-generated customer-id

__Single selection__

    (customers-table-select-by-customer-id
      sql-connection
      1000)

- Returns a list of customer-rows
- The list contains the single row matching the customer-id 1000
- The list is empty if no matching row is found

__Multiple selection__

    (customers-table-select-all
      sql-connection)

- Returns a list of all the customer-rows

__Update__

    (customers-table-update
      sql-connection
      (make-customer-row 1000 "Updated address" 8000.00))

- Updates the single customer-row matching the customer-id 1000

__Deletion__

    (customers-table-delete
      sql-connection
      (make-customer-row 1000 "Address" 5000.00))

- Deletes the single customer-row matching the customer-id 1000

Advanced operations
-------------------

__Custom selections__

    (define-table
      ...
      (custom-selects
        (customers-table-select-within-credit-limit-range
          (string-append
            "SELECT * "
            "FROM \"customers\" "
            "WHERE \"credit-limit\" >= ?1 "
            "AND \"credit-limit\" <= ?2;")
          minimum-credit-limit
          maximum-credit-limit)))

- Defines a custom selection composed of:
  - A handwritten SQL statement (must start with "SELECT *" by convention)
  - Two parameters

__Custom selections invocation__

    (customers-table-select-within-credit-limit-range
      sql-connection
      1000
      2000)

- Returns a list of customer-rows

__Custom executes__

    (define-table
      ...
      (custom-executes
        (customers-table-delete-below-minimum-credit-limit
          (string-append
            "DELETE "
            "FROM \"customers\" "
            "WHERE \"credit-limit\" < ?1;")
          minimum-credit-limit)))

- Defines a custom selection composed of:
  - A handwritten SQL statement
  - One parameter

__Custom executes invocation__

    (customers-table-delete-below-minimum-credit-limit
      sql-connection
      1000)
